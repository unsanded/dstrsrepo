pkgname=qutim-plugin-historymanager
pkgver=27
pkgrel=1
pkgdesc="Plugin to convert history from different clients to qutim"
arch=('i686' 'x86_64')
url="http://qutim.org"
license=('GPL')
makedepends=()
depends=(qt)
conflicts=()
provides=()

source=()                              
md5sums=()

_svnmod=qimhm
_svntrunk=https://qimhm.svn.sourceforge.net/svnroot/qimhm

build() {
 . ../../optimizations-$CARCH

 msg "Getting sources from SVN..."
 cd "$srcdir"
  if [ -d $_svnmod/.svn ]; then
	[ $CARCH = x86-64 ] && cd $_svnmod && svn up
  else
    svn co $_svntrunk $_svnmod
  fi

 cd $srcdir
 rm -rf $_svnmod-build
 cp -R $_svnmod $_svnmod-build
 cd $_svnmod-build
 msg "SVN checkout done or server timeout"
 msg "Starting make..."

 qmake
 make || return 1
 make INSTALL_ROOT="$pkgdir" install

 mkdir -p $pkgdir/usr/lib/qutim/
 install -Dm 644 $srcdir/libhistorymanager.so \
  $pkgdir/usr/lib/qutim/ || return 1
 cd ..
 rm -rf $_svnmod-build 

}
